# Aerial Images Semantic Segmentation with TernausNet (VGG11 + U-Net)

èˆªç©ºå†™çœŸï¼ˆUSGSæä¾›ï¼‰ã‹ã‚‰é“è·¯è¦ç´ ï¼ˆæ¨ªæ–­æ­©é“ãƒ»åœæ­¢ç·šï¼‰ã‚’ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ã‚»ã‚°ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹ãŸã‚ã®ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚

æœ¬ãƒªãƒã‚¸ãƒˆãƒªã§ã¯ã€TernausNetï¼ˆVGG11ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ã‚’ä½¿ç”¨ã—ãŸU-Netï¼‰ã‚’ç”¨ã„ã¦é“è·¯è¦ç´ ã®æŠ½å‡ºã‚’è©¦ã¿ã¦ã„ã¾ã™ã€‚

---

## ğŸ”– ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

- **å…¥åŠ›ç”»åƒ**ï¼šUSGSèˆªç©ºå†™çœŸï¼ˆç´„30cm/pxï¼‰
- **å¯¾è±¡è¦ç´ **ï¼šäº¤å·®ç‚¹ä»˜è¿‘ã®æ¨ªæ–­æ­©é“ãƒ»åœæ­¢ç·š
- **ãƒ¢ãƒ‡ãƒ«**ï¼šTernausNet (VGG11ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ä½¿ç”¨ã®U-Net)
- **ä½¿ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒª**ï¼š[segmentation-models-pytorch](https://github.com/qubvel/segmentation_models.pytorch)

---

## ğŸ“‚ ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆ
```
aerial-images-conv/
â”œâ”€â”€ dataset/
â”‚   â”œâ”€â”€ train/          # å­¦ç¿’ç”¨ç”»åƒã¨ãƒã‚¹ã‚¯ãƒ‡ãƒ¼ã‚¿
â”‚   â”œâ”€â”€ val/            # æ¤œè¨¼ç”¨ç”»åƒã¨ãƒã‚¹ã‚¯ãƒ‡ãƒ¼ã‚¿
â”‚   â””â”€â”€ inference/      # æ¨è«–ç”¨ç”»åƒ
â”œâ”€â”€ ternaus_usgs.pth    # å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ï¼ˆTernausNetï¼‰
â”œâ”€â”€ train_simple.py     # TernausNetã®ç°¡æ˜“å­¦ç¿’ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ inference.py        # TernausNetã®æ¨è«–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â””â”€â”€ requirements.txt    # Pythonç’°å¢ƒä¾å­˜é–¢ä¿‚
```

---

## ğŸš€ ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### Step 1: Pythonç’°å¢ƒæ§‹ç¯‰ (Ubuntu)
```bash
python3 -m venv ternaus_env
source ternaus_env/bin/activate
pip install -U pip setuptools wheel
pip install -r requirements.txt
```
â€»äº‹å‰ã«CUDA 11.8ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

###  Step 2: å­¦ç¿’ã®å®Ÿè¡Œ
```bash
python train_simple.py
```
å­¦ç¿’ãŒå®Œäº†ã™ã‚‹ã¨ã€ternaus_usgs.pthãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚


### Step 3: æ¨è«–ã®å®Ÿè¡Œ
æ¨è«–ç”¨ç”»åƒã‚’dataset/inferenceãƒ•ã‚©ãƒ«ãƒ€ã«æ ¼ç´ã—ã¦å®Ÿè¡Œï¼š
```bash
python inference.py
```
æ¨è«–çµæœã¯dataset/inference_resultsã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

---

## ğŸ› ï¸ ä½¿ç”¨æŠ€è¡“
Python 3.10+

PyTorchï¼ˆCUDA 11.8ï¼‰

segmentation-models-pytorch

OpenCV

USGSèˆªç©ºå†™çœŸãƒ‡ãƒ¼ã‚¿

---
## ğŸ“Œ æ³¨æ„ç‚¹
ç¾çŠ¶ã®ç²¾åº¦ã¯ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ®µéšã®ãŸã‚ã€å­¦ç¿’ãƒ‡ãƒ¼ã‚¿æ•°ãŒå°‘ãªãé™å®šçš„ã§ã™ï¼ˆ10æšç¨‹åº¦ï¼‰ã€‚

ç²¾åº¦å‘ä¸Šã®ãŸã‚ã«ã¯è¿½åŠ ãƒ‡ãƒ¼ã‚¿ã‚„è§£åƒåº¦ã®é«˜ã„èˆªç©ºå†™çœŸã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚


---

## ğŸ“– ãƒ©ã‚¤ã‚»ãƒ³ã‚¹
MIT License
